# Nexus Docker Compose Environment Configuration
# This file contains configuration for all services:
#   - PostgreSQL Database
#   - Nexus Server (Backend)
#   - LangGraph Agent Server
#   - Frontend (React UI)
#
# ============================================
# Setup Instructions
# ============================================
#
# For Local Development:
#   cp .env.example .env.local
#   # Edit .env.local with your development API keys
#   ./docker-start.sh
#
# For Production:
#   1. Use .env.production (committed to git, no secrets)
#   2. Create .env.production.secrets on server (git-ignored)
#   3. See ENV_PRODUCTION_SETUP.md for detailed instructions
#
# Alternative (Not Recommended):
#   You can edit .env.example directly and the script will use it,
#   but this is not recommended as it may cause git conflicts.
#
# ============================================

# ============================================
# PostgreSQL Database
# ============================================
POSTGRES_DB=nexus
POSTGRES_USER=postgres
POSTGRES_PASSWORD=nexus
POSTGRES_PORT=5432

# ============================================
# Nexus Server
# ============================================
NEXUS_PORT=8080

# ============================================
# MCP Server (Model Context Protocol)
# ============================================
MCP_PORT=8081

# Transport Mode: stdio (local/Claude Desktop) or http (remote/web)
# stdio: For Claude Desktop integration (local only)
# http: For remote access, web clients, production deployment
MCP_TRANSPORT=http

# Backend Connection for MCP Server
# Option 1: Connect to nexus-server (recommended for production)
NEXUS_URL=http://nexus-server:8080
# Use same API key as nexus-server

# Option 2: Local embedded mode (comment out NEXUS_URL above)
# Uses local filesystem without separate backend server
# NEXUS_BACKEND=local
# NEXUS_DATA_DIR=/app/data

# Database URL (uses PostgreSQL service)
# Auto-generated: postgresql://postgres:nexus@postgres:5432/nexus
# Override if needed:
# NEXUS_DATABASE_URL=postgresql://postgres:nexus@postgres:5432/nexus

# Authentication
# Leave empty to auto-generate admin API key on first run
# Or provide your own (format: sk-<prefix>_<username>_<uuid>_<hash>):
# Example: sk-default_admin_d38a7427_244c5f756dcc064eea6e68a64aa2111e
NEXUS_API_KEY=sk-default_admin_dddddddd_eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee

# OAuth Encryption Key (for secure token storage)
# Generate with: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# IMPORTANT: Use the same key for both local CLI and Docker server!
# NEXUS_OAUTH_ENCRYPTION_KEY=your-encryption-key-here

# Backend Storage
# Options: local (default), gcs (Google Cloud Storage)
NEXUS_BACKEND=local

# GCS Backend (only if NEXUS_BACKEND=gcs)
# NEXUS_GCS_BUCKET=your-bucket-name
# NEXUS_GCS_PROJECT=your-gcp-project-id
# GCS_CREDENTIALS_PATH=/path/to/gcs-credentials.json
# GOOGLE_APPLICATION_CREDENTIALS=/app/gcs-credentials.json

# ============================================
# LangGraph Agent Server
# ============================================
LANGGRAPH_PORT=2024

# LLM API Keys (REQUIRED for LangGraph)
ANTHROPIC_API_KEY=
# Optional
OPENAI_API_KEY=

# Optional: Additional Tool API Keys
TAVILY_API_KEY=
E2B_API_KEY=
FIRECRAWL_API_KEY=

# LangSmith tracing (optional)
LANGCHAIN_TRACING_V2=false
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com
LANGCHAIN_PROJECT=
LANGSMITH_API_KEY=

# ============================================
# Frontend
# ============================================
FRONTEND_PORT=5173

# Backend API URLs
# For local development (browser access):
VITE_NEXUS_API_URL=http://localhost:8080
VITE_LANGGRAPH_API_URL=http://localhost:2024

# For Docker internal routing (container-to-container):
# VITE_NEXUS_API_URL=http://nexus:8080
# VITE_LANGGRAPH_API_URL=http://langgraph:2024
VITE_NEXUS_SERVER_URL=http://nexus:8080

# Permission and Authentication Settings
NEXUS_SKIP_PERMISSION=false
VITE_SKIP_AUTH=false
