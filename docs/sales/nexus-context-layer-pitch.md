# Nexus - AI原生上下文层

## 一、核心定位

### 一句话定义
> Nexus 是连接 AI Agent 与企业数据世界的统一上下文层，让智能体像访问本地文件一样访问云盘、邮件、OA、数据库等所有数据源，同时确保细粒度的权限控制。

### 解决的核心问题

```
传统方式：
┌─────────┐     ┌─────────┐     ┌─────────┐
│  Agent  │────▶│   RAG   │────▶│ 向量库   │
└─────────┘     └─────────┘     └─────────┘
                    │
                    ▼
              只能检索文本片段
              无法操作原始文件
              权限管理困难
              多源接入复杂

Nexus 方式：
┌─────────┐     ┌─────────────────────────────────┐
│  Agent  │────▶│            NEXUS                │
└─────────┘     │  ┌─────┐ ┌─────┐ ┌─────┐       │
                │  │云盘  │ │邮件  │ │OA   │ ...   │
                │  └─────┘ └─────┘ └─────┘       │
                │     统一路径 + 权限 + 搜索        │
                └─────────────────────────────────┘
                    │
                    ▼
              读写原始文件
              细粒度权限控制
              多源统一命名空间
              语义+关键词混合搜索
```

---

## 二、核心能力

### 2.1 统一文件系统

**概念图：**
```
                    Nexus 统一命名空间
                          │
        ┌─────────────────┼─────────────────┐
        │                 │                 │
        ▼                 ▼                 ▼
   /云盘/公司文档/     /邮件/收件箱/      /本地/项目/
        │                 │                 │
        ▼                 ▼                 ▼
   ┌─────────┐       ┌─────────┐       ┌─────────┐
   │ 腾讯云盘  │       │  邮件系统 │       │ 本地存储  │
   │ 阿里云盘  │       │  Exchange│       │  NAS    │
   │ Google  │       │  Gmail   │       │         │
   └─────────┘       └─────────┘       └─────────┘
```

**关键价值：**
- Agent 无需知道数据实际存储位置
- 统一的读/写/搜索 API
- 支持 20+ 数据源连接器
- 可扩展的连接器架构

### 2.2 智能权限管理 (ReBAC)

**概念图：**
```
┌──────────────────────────────────────────────────────────┐
│                    权限控制层 (ReBAC)                      │
├──────────────────────────────────────────────────────────┤
│                                                          │
│   ┌─────────┐                      ┌─────────────────┐   │
│   │ Agent-A │──── can_read ───────▶│ /保险/理赔文档/   │   │
│   │ (理赔机器人)│                     └─────────────────┘   │
│   └─────────┘                                            │
│                                                          │
│   ┌─────────┐                      ┌─────────────────┐   │
│   │ Agent-B │──── can_read ───────▶│ /保险/核保文档/   │   │
│   │ (核保机器人)│     can_write       └─────────────────┘   │
│   └─────────┘                                            │
│                                                          │
│   ┌─────────┐         ✗            ┌─────────────────┐   │
│   │ Agent-C │──── blocked ────────▶│ /保险/*         │   │
│   │ (外部Agent)│                     └─────────────────┘   │
│   └─────────┘                                            │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

**权限模型：**
```
权限元组: (主体, 关系, 客体)

示例:
(agent:理赔机器人, can_read, folder:/保险/理赔/)
(agent:理赔机器人, can_write, folder:/保险/理赔/报告/)
(user:张三, owner, folder:/个人文档/)
(group:财务部, can_read, folder:/财务报表/)
```

**关键价值：**
- 基于关系的访问控制 (Google Zanzibar 架构)
- 支持用户、组、Agent 多种主体
- 权限继承 (文件夹→子文件)
- 多租户完全隔离
- 审计日志追溯

### 2.3 混合搜索引擎

**概念图：**
```
                    用户查询
                       │
                       ▼
              ┌────────────────┐
              │    查询理解     │
              └────────────────┘
                       │
         ┌─────────────┴─────────────┐
         ▼                           ▼
   ┌──────────┐                ┌──────────┐
   │ 语义搜索   │                │ 关键词搜索 │
   │ (向量相似) │                │ (BM25S)  │
   └──────────┘                └──────────┘
         │                           │
         └─────────────┬─────────────┘
                       ▼
              ┌────────────────┐
              │    结果融合     │
              │  + 权限过滤     │
              └────────────────┘
                       │
                       ▼
                  返回结果
```

**关键价值：**
- 语义理解 + 精确匹配双重保障
- 搜索结果自动权限过滤
- 支持跨数据源搜索
- 500x 更快的 BM25S 排序

### 2.4 文档解析

**支持格式：**
```
┌────────────────────────────────────────────┐
│              30+ 文档格式支持                │
├────────────┬────────────┬─────────────────┤
│ 办公文档    │ 技术文档    │ 其他格式         │
├────────────┼────────────┼─────────────────┤
│ .docx      │ .md        │ .pdf            │
│ .xlsx      │ .json      │ .html           │
│ .pptx      │ .xml       │ .eml (邮件)      │
│ .doc       │ .yaml      │ .msg            │
│ .xls       │ .csv       │ 图片 (OCR)       │
│ .ppt       │ .txt       │ 音频 (转写)      │
└────────────┴────────────┴─────────────────┘
```

---

## 三、技术架构

### 整体架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        应用层 (客户自建)                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │ 文档问答   │  │ 会议助手   │  │ 智能归档   │  │ 报告生成   │        │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │
├─────────────────────────────────────────────────────────────────┤
│                        Agent 层 (可选)                           │
│  ┌──────────────────────────────────────────────────────┐       │
│  │  LangGraph / CrewAI / OpenAI Agents / 自研 Agent      │       │
│  └──────────────────────────────────────────────────────┘       │
├─────────────────────────────────────────────────────────────────┤
│                     ★ NEXUS 上下文层 ★                           │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                         │    │
│  │   ┌──────────┐  ┌──────────┐  ┌──────────┐             │    │
│  │   │ 统一文件   │  │ 权限管理   │  │ 搜索引擎   │             │    │
│  │   │ 系统      │  │ (ReBAC)  │  │          │             │    │
│  │   └──────────┘  └──────────┘  └──────────┘             │    │
│  │                                                         │    │
│  │   ┌──────────┐  ┌──────────┐  ┌──────────┐             │    │
│  │   │ 连接器    │  │ 文档解析   │  │ 版本管理   │             │    │
│  │   │ 管理器    │  │          │  │          │             │    │
│  │   └──────────┘  └──────────┘  └──────────┘             │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
├─────────────────────────────────────────────────────────────────┤
│                        连接器层                                  │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐      │
│  │云盘 │ │邮件 │ │OA  │ │SQL │ │S3  │ │NAS │ │API │ │... │      │
│  └────┘ └────┘ └────┘ └────┘ └────┘ └────┘ └────┘ └────┘      │
├─────────────────────────────────────────────────────────────────┤
│                        数据源层                                  │
│  腾讯云盘 | 阿里云盘 | Exchange | 企业微信 | 钉钉 | OA系统 | ...    │
└─────────────────────────────────────────────────────────────────┘
```

### 部署模式

```
┌─────────────────────────────────────────────────────────────┐
│                       三种部署模式                            │
├───────────────┬───────────────────┬─────────────────────────┤
│   嵌入式模式    │     服务器模式      │      分布式模式          │
│   (Embedded)  │     (Server)      │    (Distributed)       │
├───────────────┼───────────────────┼─────────────────────────┤
│               │                   │                         │
│  ┌─────────┐  │   ┌───────────┐   │   ┌─────┐ ┌─────┐      │
│  │  App    │  │   │  Nexus    │   │   │Node1│ │Node2│ ...  │
│  │ + Nexus │  │   │  Server   │   │   └─────┘ └─────┘      │
│  │ (SQLite)│  │   │(PostgreSQL)   │       │         │       │
│  └─────────┘  │   └───────────┘   │       ▼         ▼       │
│               │        │          │   ┌─────────────────┐   │
│               │        ▼          │   │  PostgreSQL     │   │
│  适用:        │   ┌─────────┐     │   │  Cluster        │   │
│  - 开发测试    │   │ 多客户端  │     │   └─────────────────┘   │
│  - 单机部署    │   └─────────┘     │                         │
│  - 快速原型    │                   │   适用:                  │
│               │   适用:            │   - 大规模企业            │
│               │   - 团队使用        │   - 高可用要求            │
│               │   - 多租户          │   - 水平扩展              │
└───────────────┴───────────────────┴─────────────────────────┘
```

---

## 四、客户场景对应

### 场景一：文档智能检索 (替代传统 RAG)

**痛点：**
- 文档分散在云盘、本地、邮件等多处
- 传统 RAG 只能检索文本片段
- 无法追溯原始文档
- 权限管理困难

**Nexus 方案：**
```
┌──────────────────────────────────────────────────────────┐
│                                                          │
│   用户提问: "找一下上个月的项目进度报告"                      │
│                         │                                │
│                         ▼                                │
│   ┌─────────────────────────────────────────────┐       │
│   │              Nexus 搜索引擎                   │       │
│   │  1. 语义理解 → 项目 + 进度 + 报告             │       │
│   │  2. 时间过滤 → 上个月                        │       │
│   │  3. 跨源搜索 → 云盘 + 邮件 + 本地             │       │
│   │  4. 权限过滤 → 只返回有权限的文档             │       │
│   └─────────────────────────────────────────────┘       │
│                         │                                │
│                         ▼                                │
│   返回结果:                                              │
│   ├── /云盘/项目文档/2024-12月进度报告.docx              │
│   ├── /邮件/收件箱/RE: 12月项目进度汇总.eml              │
│   └── /本地/周报/Week52-项目进度.md                     │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 场景二：多 Agent 权限隔离 (金融客户)

**痛点：**
- 多个 Agent 访问敏感数据
- 权限边界模糊
- 数据交叉泄露风险
- 审计追溯困难

**Nexus 方案：**
```
┌──────────────────────────────────────────────────────────┐
│                    金融机构 Agent 管理                     │
├──────────────────────────────────────────────────────────┤
│                                                          │
│  ┌─────────────┐          ┌─────────────────────────┐   │
│  │ PICC 理赔    │          │                         │   │
│  │ Agent       │─────────▶│  /picc/claims/          │   │
│  │             │  ✓读写    │  ├── 理赔单/             │   │
│  └─────────────┘          │  ├── 定损报告/           │   │
│                           │  └── 赔付记录/           │   │
│  ┌─────────────┐          │                         │   │
│  │ PICC 核保    │          ├─────────────────────────┤   │
│  │ Agent       │─────────▶│  /picc/underwriting/    │   │
│  │             │  ✓读写    │  ├── 投保申请/           │   │
│  └─────────────┘          │  ├── 风险评估/           │   │
│                           │  └── 核保意见/           │   │
│  ┌─────────────┐          │                         │   │
│  │ 平安保险     │          ├─────────────────────────┤   │
│  │ Agent       │────✗────▶│  /picc/* (完全隔离)     │   │
│  │             │          │                         │   │
│  └─────────────┘          └─────────────────────────┘   │
│                                                          │
│  审计日志:                                               │
│  [2024-01-15 10:30] PICC理赔Agent 读取 /picc/claims/C001│
│  [2024-01-15 10:31] 平安Agent 尝试访问 /picc/ → 拒绝     │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

### 场景三：会议记录智能分析

**架构：**
```
┌──────────────────────────────────────────────────────────┐
│                                                          │
│                    ┌──────────────┐                     │
│                    │  会议助手     │                     │
│                    │  Agent       │                     │
│                    └──────────────┘                     │
│                           │                              │
│              ┌────────────┼────────────┐                │
│              ▼            ▼            ▼                │
│         查询历史      获取议程      发送通知              │
│              │            │            │                │
│              ▼            ▼            ▼                │
│  ┌───────────────────────────────────────────────────┐  │
│  │                    NEXUS                          │  │
│  │  /会议/历史/    /日历/今日/    /邮件/发件箱/        │  │
│  └───────────────────────────────────────────────────┘  │
│              │            │            │                │
│              ▼            ▼            ▼                │
│         会议系统       日历系统       邮件系统            │
│                                                          │
└──────────────────────────────────────────────────────────┘

工作流程:
1. Agent 查询: /会议/历史/*部门例会* → 获取历史会议记录
2. Agent 分析: 提取历史决议、待办事项
3. Agent 生成: 本次会议建议议程
4. Agent 执行: 发送会议通知到 /邮件/发件箱/
```

---

## 五、与传统方案对比

### 对比表

```
┌────────────────┬─────────────────┬─────────────────┬─────────────────┐
│     能力        │   传统文件系统    │   传统 RAG      │    Nexus        │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 多源数据接入    │      ✗          │      △          │      ✓          │
│                │  单一存储        │  需要ETL        │  统一命名空间    │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 语义搜索       │      ✗          │      ✓          │      ✓          │
│                │  仅文件名        │  文本片段        │  文件级+片段级   │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 权限管理       │      △          │      ✗          │      ✓          │
│                │  粗粒度          │  通常无         │  细粒度ReBAC    │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ Agent友好     │      ✗          │      △          │      ✓          │
│                │  需要适配        │  只读检索        │  原生支持读写    │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 文件操作       │      ✓          │      ✗          │      ✓          │
│                │  完整支持        │  无法操作        │  完整支持       │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 版本追溯       │      △          │      ✗          │      ✓          │
│                │  部分支持        │  无             │  完整版本历史    │
├────────────────┼─────────────────┼─────────────────┼─────────────────┤
│ 审计日志       │      △          │      ✗          │      ✓          │
│                │  系统级          │  无             │  操作级详细日志  │
└────────────────┴─────────────────┴─────────────────┴─────────────────┘
```

### 架构演进

```
传统 RAG 架构:
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│ 数据源   │───▶│  ETL    │───▶│ 向量化   │───▶│ 向量库   │
└─────────┘    └─────────┘    └─────────┘    └─────────┘
                                                  │
┌─────────┐                                       ▼
│  Agent  │◀─────────────────────────────────  检索结果
└─────────┘                                    (文本片段)

问题:
- 数据孤岛，需要ETL
- 只能检索，无法操作
- 权限丢失
- 无法追溯原文档


Nexus 架构:
┌─────────┐    ┌─────────────────────────────────────┐
│  Agent  │───▶│              NEXUS                  │
└─────────┘    │  ┌─────────────────────────────┐    │
      ▲        │  │  统一接口 (读/写/搜索/权限)    │    │
      │        │  └─────────────────────────────┘    │
      │        │         │           │               │
      │        │         ▼           ▼               │
      │        │    ┌────────┐  ┌────────┐          │
      │        │    │ 连接器A │  │ 连接器B │  ...     │
      │        │    └────────┘  └────────┘          │
      │        └─────────────────────────────────────┘
      │                  │           │
      │                  ▼           ▼
      │             数据源A       数据源B
      │
    完整文件 + 元数据 + 权限信息

优势:
- 实时接入，无需ETL
- 读写操作完整支持
- 权限透传
- 原文档可追溯
```

---

## 六、已支持的连接器

### 云存储
| 连接器 | 状态 | 说明 |
|-------|------|------|
| Google Drive | ✅ | OAuth 认证 |
| AWS S3 | ✅ | IAM 认证 |
| Google Cloud Storage | ✅ | 服务账号 |
| 本地文件系统 | ✅ | 直接访问 |

### 通讯协作
| 连接器 | 状态 | 说明 |
|-------|------|------|
| Gmail | ✅ | OAuth 认证 |
| Slack | ✅ | OAuth 认证 |
| 企业微信 | 🔜 | 规划中 |
| 钉钉 | 🔜 | 规划中 |

### 定制开发
| 连接器 | 状态 | 说明 |
|-------|------|------|
| 自定义 REST API | ✅ | 通用适配器 |
| SQL 数据库 | 🔜 | 规划中 |
| OA 系统 | 🔧 | 可定制开发 |

---

## 七、技术规格

### 性能指标
- 搜索延迟: < 100ms (95th percentile)
- 权限检查: < 10ms
- 文件读取: 取决于底层存储
- 并发支持: 1000+ 连接

### 安全特性
- 传输加密: TLS 1.3
- 存储加密: AES-256
- 权限模型: ReBAC (关系型访问控制)
- 审计日志: 完整操作记录
- 多租户隔离: 租户边界强制执行

### 部署要求
| 模式 | 最低配置 | 推荐配置 |
|------|---------|---------|
| 嵌入式 | 1核 1GB | 2核 4GB |
| 服务器 | 2核 4GB | 4核 8GB |
| 分布式 | 4核 8GB × N | 8核 16GB × N |

---

## 八、合作模式

### 项目实施路径

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  第一阶段: POC 验证 (2-4周)                                  │
│  ├── 部署 Nexus 服务                                        │
│  ├── 接入 2-3 个数据源                                      │
│  ├── 配置权限规则                                           │
│  └── 演示检索 + 权限隔离                                    │
│                                                             │
│  第二阶段: 应用集成 (4-8周)                                  │
│  ├── 集成客户现有 Agent                                     │
│  ├── 开发定制连接器 (如需)                                   │
│  ├── 配置多租户/多Agent权限                                  │
│  └── 上线核心使用场景                                        │
│                                                             │
│  第三阶段: 规模化部署                                        │
│  ├── 接入更多数据源                                         │
│  ├── 扩展 Agent 应用                                        │
│  ├── 性能优化                                               │
│  └── 运维支持                                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 商业模式

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  基础授权                                                    │
│  └── Nexus 平台使用授权                                      │
│                                                             │
│  实施服务                                                    │
│  ├── 定制连接器开发                                          │
│  ├── 权限策略设计                                            │
│  └── 系统集成                                               │
│                                                             │
│  持续服务                                                    │
│  ├── 技术支持                                               │
│  ├── 版本升级                                               │
│  └── 运维保障                                               │
│                                                             │
│  增值服务                                                    │
│  ├── Agent 开发咨询                                         │
│  └── 最佳实践培训                                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 九、总结

### Nexus 核心价值

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   1. 统一接入                                                │
│      多源数据 → 统一路径 → Agent 无感知底层差异               │
│                                                             │
│   2. 权限可控                                                │
│      细粒度 ReBAC → 多Agent隔离 → 审计可追溯                 │
│                                                             │
│   3. 智能检索                                                │
│      语义+关键词 → 权限过滤 → 原文档可操作                    │
│                                                             │
│   4. 开放扩展                                                │
│      连接器架构 → 可定制开发 → 适配企业现有系统                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 一句话

> **Nexus 是 AI Agent 的"操作系统级"数据访问层，让企业安全、高效地释放 Agent 的生产力。**

---

*文档版本: v1.0*
*更新日期: 2025-01*
